<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, target-densitydpi=medium-dpi">
	<title>서명관리</title>
	<link rel="stylesheet" type="text/css" href="../../css/style.css">
	<link rel="stylesheet" type="text/css" href="../../css/sample.css">
	<link rel="stylesheet" type="text/css" href="../../css/sign_css.css">
	<script type="text/javascript" src="../../js/mcore.min.js"></script>
	<script src="../../js/signature_pad.min.js" type="text/javascript"></script>
</head>
<body>

    <div class="wrapper">

        <!-- header -->
        <header id="header">
            <h1>서명관리</h1>
            <button type="button" onclick="return false;" data-button="back" class="tbtn_l tbtn_prev" id="btn_back">이전</button>
            <button type="button" class="tbtn_home" title="홈">홈</button>
        </header>

        <section class="content bge" id="content">
			
			

            <div id="signature-pad" class="m-signature-pad">
				<div>
					<div class="app-search ac s2 m-signature-pad--footer">				
						<div class="description"><img id="preimg" width="auto" height="100px"></div>
					</div> 
				</div>
				<div class="sign-box">
					<div class="sign m-signature-pad--body">
						<canvas></canvas>
					</div>
				</div>
			</div>
        </section>
        <div class="btn-footer2">
			<button class="btn-secondary w40p pa10 clear" data-action="clear">지우기</button>
			<button class="btn-secondary w60p pa10 save" data-action="save">저장</button>
		</div>
    </div>


	<script>
		var canvas = $("#signature-pad canvas")[0];
		var sign = new SignaturePad(canvas, {
			minWidth: 5,
			maxWidth: 10,
			penColor: "rgb(66, 133, 244)"
		});
		
		$("[data-action]").on("click", function(){
			if ( $(this).data("action")=="clear" ){
				sign.clear();
			}
			else if ( $(this).data("action")=="save" ){
				if (sign.isEmpty()) {
					alert("사인해 주세요!!");
				} else {
					$("#preimg").attr("src", sign.toDataURL());
					/*$.ajax({
						url : "save.jsp",
						method : "post",
						dataType : "json",
						data : {
							sign : sign.toDataURL()
						},
						success : function(r){
							alert("저장완료 : " + r.filename);
							sign.clear();
						},
						error : function(res){
							console.log(res);
						}
					});*/
				}
			}
		});
		
		
		function resizeCanvas(){
			var canvas = $("#signature-pad canvas")[0];
	
			var ratio =  Math.max(window.devicePixelRatio || 1, 1);
			canvas.width = canvas.offsetWidth * ratio;
			canvas.height = canvas.offsetHeight * ratio;
			canvas.getContext("2d").scale(ratio, ratio);
		}
	    
	    $(window).on("resize", function(){
			resizeCanvas();
		});

		resizeCanvas();
    </script>
</body>
</html>